var Bose=Bose||{};Bose.KlarnaBanner=function(){function a(){var a=$jq(h.variantDropdownSelector);f=$jq(h.klarnaPrequalify),a.val()?Bose.DataLayer.setVariable("Product","selectedVariantCode",a.val()):Bose.DataLayer.setVariable("Product","selectedVariantCode",$jq(".bose-colorItem--selected").data("variant-code")),f.length&&($jq(document).on("variantChanged",b),void 0!==Bose.DataLayer.Data.Product&&void 0!==Bose.DataLayer.Data.Product.selectedVariantCode&&f.data("selected-variant",Bose.DataLayer.Data.Product.selectedVariantCode),c())}function b(a,b,e,i,j,k,l,m,n){if(n)return g=$jq(h.incentiveBundle).data("total-price"),void c();f.data("selected-variant")!==e&&(f.data("selected-variant",e),c(),d())}function c(){var a,b=Math.round(100*e(f.data("selected-variant"))),c=$jq(h.klarnaBanner),d=c.data("klarnaUci"),g=c.data("klarnaDataid"),j=c.data("inline"),k=j?'data-inline="true"':"",l={},m=100*$jq(h.inputMinValue).val(),n=100*$jq(h.inputMaxValue).val();if(void 0!==window.KlarnaOnsiteService&&(window.KlarnaOnsiteService=[]),b<m||b>n)return void $jq(h.klarnaBanner).removeClass(i.show);$jq(h.klarnaBanner).addClass(i.show),l.url=d,l.dataId=g,a='<script type="text/javascript" >(function(d,t) {"use strict"; var s = d.getElementsByTagName(t)[0], n = d.createElement(t); n.src = "{url}"; s.parentNode.insertBefore(n, s); }(document, "script")); <\/script> <klarna-placement data-id= "{dataId}"data-purchase_amount= "'+b+'" '+k+"></klarna-placement>",f.empty().html(nano(a,l))}function d(){void 0!==window.KlarnaOnsiteService&&window.KlarnaOnsiteService.push({eventName:"refresh-placements"})}function e(a){var b="",c=$jq(h.priceContainer),d=c.data("priceProductcodemapping");return void 0===Bose.DataLayer.Data.Page||"productpage"!==Bose.DataLayer.Data.Page.type&&"productSubPage"!==Bose.DataLayer.Data.Page.type&&"contentpage"!==Bose.DataLayer.Data.Page.type&&"homepage"!==Bose.DataLayer.Data.Page.type&&"categorypage"!==Bose.DataLayer.Data.Page.type||void 0===d||void 0===a||void 0===d[a]||(b=d[a].originalPriceValue),g&&(b=g),b}var f,g,h={klarnaBanner:".bose-klarnaBanner",klarnaPrequalify:".js-bose-klarnaPrequalify",klarnaWidget:".js-boseKlarna-widget",incentiveBundle:".js-bose-incentiveBundles",language:".js-bose-locale",priceContainer:".bose-price",variantDropdownSelector:".bose-variantSelector__variants",inputMinValue:'input[name="klarnaMinimumValue"]',inputMaxValue:'input[name="klarnaMaximumValue"]'},i={show:"bose-klarnaBanner--show"};return{init:a,_selectors:h}}();
$jq(window).load(function(){Bose.KlarnaBanner.init()});
